
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>注册</title>
<link rel="stylesheet" type="text/css" href="./css/login-1.css" />
<link rel="stylesheet" type="text/css" href="./css/login-2.css"/>
<script type="text/javascript" src="https://img3.tieyou.com/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="https://img3.tieyou.com/js/loginInfoUtf8_qianyi.js?v=20150316.22"></script>
</head>
<body>
<script>

	function loginRedirect() {
		var url = location.href;
		var redirectIndex = url.indexOf('?redirect=');
		if (redirectIndex > 0) {
			var redirectUrl = url.substr(redirectIndex + 10);
			location.href = location.href;
			return;
		}

		if (location.href.indexOf('/passport/login.html') < 0) {
			location.href = '/passport/login.html?redirect=' + location.href;
		} else {
			location.href = location.href;
		}
	}

    function wxLoginRedirect(){
        $(".wxewm").show();
        startCheck();
    }
    function startCheck(){
        setInterval(function(){
            if(times++ > 40){
                return false;
            }
            $.get("/index.php?param=/weixin/check.html&_r=" + Math.random()*10, function(data){
                if(data.code == 1){
                    $.get("/index.php?param=/weixin/autoLogin.html&sceneid=" + data.sceneid, function(_data){
                        if(_data.code == 1){
                            window.location.href = '/index.php?param=/member/userCenter';
                        }
                    }, 'json');
                }
            }, 'json');
        }, 5000);
    }
	function qqLoginRedirect() {
		var url = location.href;
		var redirectIndex = url.indexOf('?redirect=');
		if (redirectIndex > 0) {
			var redirectUrl = url.substr(redirectIndex + 10);
			SetCookie('__P_Redirect', redirectUrl);
			location.href = '/signjoint_qq_login.html';
			return;
		}

		if (location.href.indexOf('/passport/login.html') < 0) {
			location.href = '/signjoint_qq_login.html';
		} else {
			SetCookie('__P_Redirect', location.href);

			location.href = '/signjoint_qq_login.html';
		}
	}

	function alipayLoginRedirect() {
		var url = location.href;
		var redirectIndex = url.indexOf('?redirect=');
		if (redirectIndex > 0) {
			var redirectUrl = url.substr(redirectIndex + 10);
			SetCookie('__P_Redirect', redirectUrl);
			location.href = '/signjoint_alipay_login.html';
			return;
		}

		if (location.href.indexOf('/passport/login.html') < 0) {
			location.href = '/signjoint_alipay_login.html';
		} else {
			SetCookie('__P_Redirect', location.href);
			location.href = '/signjoint_alipay_login.html';
		}
	}
	$(document).ready(function(){
        $("#weixin").mouseover(function(){
            $(".wxewm").show();
            startCheck();
        });
        function startCheck(){
            setInterval(function(){
                if(times++ > 40){
                    return false;
                }
                $.get("/index.php?param=/weixin/check.html&_r=" + Math.random()*10, function(data){
                    if(data.code == 1){
                        $.get("/index.php?param=/weixin/autoLogin.html&sceneid=" + data.sceneid, function(_data){
                            if(_data.code == 1){
                                window.location.href = '/index.php?param=/member/userCenter';
                            }
                        }, 'json');
                    }
                }, 'json');
            }, 5000);
        }

		var localURL = window.location.href;
		var kefuURL = 'https://u.tieyou.com/index.php?param=/consult/zixunIndex&act=myconsult';
        if(localURL.indexOf('qiche')>-1){
            kefuURL += '&pageID=tieyouZ&Product_Line=2';
        }else{
            if(localURL.indexOf('daigou')>-1){
                kefuURL += '&pageID=tieyouB';
            }else if(localURL.indexOf('buy')>-1){
                kefuURL += '&pageID=tieyouC';
            }else if(localURL.indexOf('payment')>-1){
                kefuURL += '&pageID=tieyouD';
            }else if(localURL.indexOf('userCenter')>-1){
                kefuURL += '&pageID=tieyouF';
            }else if(localURL.indexOf('trainOrderList')>-1){
                kefuURL += '&pageID=tieyouG';
            }else if(localURL.indexOf('busOrderList')>-1){
                kefuURL += '&pageID=tieyouAB';
            }else if(localURL.indexOf('trainOrderDetail')>-1){
                kefuURL += '&pageID=tieyouH&Order_id=';
            }else{
                kefuURL += '&pageID=tieyouZ';
            }
        }

		$('#user_kefuurl').attr('href', kefuURL);
		$('#usernotice_kefuurl').attr('href', kefuURL);

		$(".top_menu_down_gq")
			.mouseover(function(){
				$(this).removeClass("top_menu_down_gq");
				$(this).addClass("top_menu_up_gq");})
			.mouseout(function(){
				$(this).removeClass("top_menu_up_gq");
				$(this).addClass("top_menu_down_gq");})
		});


</script>
<div class="w960 header">
	
		<div class="head_ad">
	</div>
</div>
<script>
	$(function() {
		$('.top_menu_down').mouseover(function() {
			$(this).removeClass('top_menu_down').addClass('top_menu_up');
		}).mouseout(function(){
			$(this).removeClass('top_menu_up').addClass('top_menu_down');
		});
        $('.top_menu_down_ty').mouseover(function() {
            $(this).removeClass('top_menu_down_ty').addClass('top_menu_up_ty');
        }).mouseout(function(){
                    $(this).removeClass('top_menu_up_ty').addClass('top_menu_down_ty');
        });
    })
</script>
<div class="w960 content">
            
	<ol class="yz_lc">
		<li class="line_done"></li>
		<li class="event_done">
			<label>1</label>
			<span>填写注册信息</span>
		</li>
		<li class="line_done"></li>
		<li class="line_done"></li>
		<li class="event">
			<label>2</label>
			<span>验证手机</span>
		</li>
		<li class="line"></li>
		<li class="line"></li>
		<li class="event">
			<label>3</label>
			<span>注册成功</span>
		</li>
		<li class="line"></li>
	</ol>

	<div class="clear h30"></div>

	<div class="registerbox mtop10">
		<form method="post" id="mobile_reg_form" autocomplete="off">
		<div class="reg_list">
			<dl class="reg_nav">
				<dt><a class="reg_on" href="javascript:void(0)">手机注册<b></b></a></dt>
                <dt><a class="reg_on" href="javascript:void(0)"></a></dt>
			</dl>
			<ul class="reg_txt">
				<li>
					<span class="reg-label"><label>手机号码</label></span>
					<input type="text" class="input_out" id="mobile" name="mobile" maxlength="11" autocomplete="off" value="" onfocus="this.className='input_on';" onblur="this.className='input_out';" tabindex="1" />
					<span style="display:none;" id="lay" class="yz_txt"><b></b><i></i>注册成功后，可使用此手机号码登陆网站</span>
					<span class="yz_ok" style="display:none;"></span>
					<span class="red_ts" style="display:none;"></span>
				</li>
				<li>
					<span class="reg-label"><label>登录密码</label></span>
					<input type="password" class="input_out" id="password" name="password" maxlength="21" autocomplete="off" onfocus="this.className='input_on';" onblur="this.className='input_out';" tabindex="2" />
					<span style="display:none;" id="lay2" class="yz_txt"><b></b><i></i>6-20个字符，可使用字母、数字或符号的组合</span>
					<span class="yz_ok" style="display:none;"></span>
					<span class="red_ts" style="display:none;"></span>
				</li>
				<li>
					<span class="reg-label"><label>确认登录密码</label></span>
					<input type="password" class="input_out" id="con_password" name="con_password" maxlength="21" autocomplete="off" onfocus="this.className='input_on';" onblur="this.className='input_out';" tabindex="3" />
					<span style="display:none;" id="lay3" class="yz_txt"><b></b><i></i>请再次输入密码</span>
					<span class="yz_ok" style="display:none;"></span>
					<span class="red_ts" style="display:none;"></span>
				</li>
				<li>
					<span class="reg-label"><label>验证码</label></span>
					<input type="text" class="input_out" id="check_code" name="check_code" maxlength="4" autocomplete="off" onfocus="this.className='input_on';" onblur="this.className='input_out';" style="width:100px" tabindex="4" />
                    <img style="cursor:pointer" class="yzm" id="img_check_code" src="http://www.tieyou.com/index.php?param=/yanzhengma/getYanzhengmaPic.html" onclick="this.src='http://www.tieyou.com/index.php?param=/yanzhengma/getYanzhengmaPic.html&t=' + new Date().getTime();" />
                    <a href="#" onclick="document.getElementById('img_check_code').src='http://www.tieyou.com/index.php?param=/yanzhengma/getYanzhengmaPic.html&t=' + new Date().getTime();" class="yzm_ch">看不清？换一张</a>
					<span style="left:425px;_left:210px;width:80px;display:none;" id="lay4" class="yz_txt"><b></b><i></i>请输入验证码</span>
					<span class="yz_ok" style="display:none;"></span>
					<span class="red_ts" style="left:425px;_left:210px;display:none;"></span>
				</li>
				<li class="agreement"><label><input id="agree" type="checkbox" checked="checked" />我已阅读并同意遵守</label><a href="xieyi.html" target="_blank">《小票网服务协议》</a></li>
				<li class="btn-long"><button id="mobile_reg_form_submit" tabindex="5" ><span style="color:black;">下一步</button></li>

			</ul>
		</div>
		</form>
		
	</div>
        
	<div class="reg_ad">
	</div>
</div>

<script>
	$(function() {
		var MobileReg = {
			mobile: '',
			password: '',
			conpwd: '',
			mobile_pattern: /^1[345678]\d{9}$/,
			password_pattern: /^\S{6,20}$/,
			checkMobileStatus: 0,
			checkPwdStatus: 0,
			checkImgStatus: 0,
			checkUrl: '/ajax/regMobileCheck.html',
			validateMobile: function() {
				var li = $('#mobile').parent('li');
				
				$('#lay').hide();
				li.find('.red_ts').hide();
				li.find('.yz_ok').hide();
				
				if (!this.mobile.length) {
					MobileReg.checkMobileStatus = 0;
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>请输入手机').show();
					return;
				}

				if (!this.mobile_pattern.test(this.mobile)) {
					MobileReg.checkMobileStatus = 0;
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>您输入的手机格式不正确').show();
					return;
				}

                MobileReg.checkMobileStatus = 1;
			},

            checkMobileState:function(data){
                var li = $('#mobile').parent('li');

                if (data) {
                    if (data.success > 0) {
                        li.removeClass('red_bor').find('.red_ts').hide().html('');
                        li.find('.yz_ok').css('display', '');
                        MobileReg.checkMobileStatus = 1;
                    } else if (data.success == -2) {
                        MobileReg.checkMobileStatus = 0;
                        li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>此手机已经注册，但尚未激活，<a href="' + '/account/mobileValidate.html?action=mobileReg&mobile=' + MobileReg.mobile + '">去激活</a>').show();
                        li.find('.yz_ok').hide();
                    } else {
                        MobileReg.checkMobileStatus = 0;
                        li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>此手机已经注册，请重新输入或去<a href="/passport/login.html">登录</a>').show();
                        li.find('.yz_ok').hide();
                    }
                }
            },

			validatePassword: function() {
				var li = $('#password').parent('li');
				
				$('#lay2').hide();
				li.find('.red_ts').hide();
				li.find('.yz_ok').hide();
				
				if (!this.password.length) {
					MobileReg.checkPwdStatus = 0;
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>请输入密码').show();
					return;
				}

				if (!this.password_pattern.test(this.password)) {
					MobileReg.checkPwdStatus = 0;
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>6-20个字符，可使用字母、数字或符号的组合').show();
					return;
				}
				MobileReg.checkPwdStatus = -1;
				li.removeClass('red_bor').find('.red_ts').hide().html('');
				li.find('.yz_ok').css('display', '');
			},
			validateConPwd: function() {
				var conPwd = $('#con_password');
				var password = $('#password');
				var li = conPwd.parent('li');
				
				$('#lay3').hide();
				li.find('.red_ts').hide();
				li.find('.yz_ok').hide();
				
				if (!this.conpwd.length) {
					MobileReg.checkPwdStatus = 0;
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>请输入确认密码').show();
					return;
				}
				
				if (this.conpwd != this.password) {
					MobileReg.checkPwdStatus = 0;
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>两次输入的密码不一致').show();
					return;
				}
				MobileReg.checkPwdStatus = 1;
				li.removeClass('red_bor').find('.red_ts').hide().html('');
				li.find('.yz_ok').css('display', '');
			},
			register: function() {
				if (MobileReg.checkMobileStatus === 0) {
					this.validateMobile();
					return;
				}
				
				if (MobileReg.checkPwdStatus === 0) {
					this.validatePassword();
					return;
				}
				
				if (MobileReg.checkPwdStatus <= 0) {
					this.validateConPwd();
					return;
				}
				
				if (MobileReg.checkImgStatus === 0) {
					$('#check_code').blur();
					return;
				}
			
				if ($('#agree').attr('checked') === false) {
					alert('请同意遵守小票网服务协议');
					return;
				}
				
				$('#mobile_reg_form').submit();
			}
		}
		
		var ImageCodeCheck = {
			checkCode: '',
			checkUrl: '/ajax/checkImgVerifyCode.html',
			status: 0,
			validate: function() {
				$.ajax({
					url: this.checkUrl,
					type: 'get',
					data: {checkCode: this.checkCode, s:'c'},
					dataType: 'json',
					success: function(data) {
						if (data) {
							if (data.success) {
								ImageCodeCheck.validateCallback(data);
							} 
						}
					}
				})
			},
			validateCallback: function(data) {

			}
		};

        MobileReg.checkMobileState("");
		
		$('#mobile').blur(function() {
			MobileReg.mobile = $('#mobile').val();
			MobileReg.validateMobile();
		}).mousedown(function() {
			var li = $('#mobile').parent('li');
			$('#lay').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		}).focus(function() {
			var li = $('#mobile').parent('li');
			$('#lay').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		});
				
		$('#password').blur(function() {
			MobileReg.password = $('#password').val();
			MobileReg.validatePassword();
		}).mousedown(function() {
			var li = $('#password').parent('li');
			$('#lay2').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		}).focus(function() {
			var li = $('#password').parent('li');
			$('#lay2').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		});
		
		$('#con_password').blur(function() {
			MobileReg.conpwd = $('#con_password').val();
			MobileReg.validateConPwd();
		}).mousedown(function() {
			var li = $('#con_password').parent('li');
			$('#lay3').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		}).focus(function() {
			var li = $('#con_password').parent('li');
			$('#lay3').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		});
		
		$('#check_code').blur(function() {
			var imgCode = $('#check_code');
			var li = imgCode.parent('li');
			
			li.find('.red_ts').hide().html('');
			li.find('.yz_ok').hide();
			
			if ($('#lay4')) {
				$('#lay4').hide();
			}
			
			if (!imgCode.val().length) {
				li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>请输入验证码').show();
				return;
			}
			
			if (!/^[0-9a-zA-Z]{4}$/.test(imgCode.val())) {
				li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>验证码格式不正确').show();
				return;
			}
			
			ImageCodeCheck.checkCode = imgCode.val();
			ImageCodeCheck.validate();
			ImageCodeCheck.validateCallback = function(data) {
				if (data.success < 1) {
					MobileReg.checkImgStatus = 0;
					document.getElementById('img_check_code').src='http://www.tieyou.com/index.php?param=/yanzhengma/getYanzhengmaPic.html&t=' + new Date().getTime();
					li.addClass('red_bor').find('.red_ts').html('<b></b><i></i>验证码不正确').show();
				} else {
					MobileReg.checkImgStatus = 1;
					li.removeClass('red_bor').find('.red_ts').hide().html('');
					li.find('.yz_ok').css('display', '');
				}
			}
		}).mousedown(function() {
			var li = $('#check_code').parent('li');
			$('#lay4').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		}).focus(function() {
			var li = $('#check_code').parent('li');
			$('#lay4').show();
			li.find('.red_ts').hide();
			li.find('.yz_ok').hide();
		});
		
		$('#mobile_reg_form_submit').click(function() {
			MobileReg.mobile = $('#mobile').val();
			MobileReg.password = $('#password').val();
			MobileReg.conpwd = $('#con_password').val();
			MobileReg.register();
			return false;
		});
	})
</script>
<!--无票推荐手机客户端下载-->
<div id="wapunload" style="display:none;">
	<div class="shadow"></div>
    <div class="tipWin tip_app">
        <a href="javascript:void(0);" class="tipWin_close"></a>
        <dl>
        	<dt>下载铁友火车票超级版</dt>
        	<dd class="fl">
        		<label>短信获取下载链接</label>
        		<input type="text" value="输入手机号码" class="txt190" id="wh_txt190"/>
        		<div class="warn_box">
        			<p class="red" id='phonefomat' style="display:none">手机号码格式有误</p>
        			<p class="green" id='psuccfomat' style="display:none">短信已发送，<span id='daojishi'></span>秒后重新发送</p>
        		</div>
        		<input type="button" value="免费发送" class="btn_send"  id="btn_send_12306"/><!--不可按时用“btn_send_off”-->
        		<div class="app_arr">
        			手机扫描二维码下载
        		</div>
        	</dd>
        	<dd class="fr">
        		<img src="https://img3.tieyou.com/images/user_ewm.gif" />
        	</dd>
        </dl>
        <br class="clear" />
    </div>
</div>  
<div class="w960 copyright">
	<p>
		<a target="_blank" href="xieyi.html">关于我们</a> |
		<a target="_blank" href="xieyi.html">免责声明</a> | 
		<a target="_blank" href="xieyi.html">常见问题</a> |
		<a target="_blank" href="xieyi.html">服务说明</a> |  
		<a target="_blank" href="xieyi.html">申请加盟</a> |  
		<a target="_blank" href="xieyi.html">友情链接</a> | 
		<a target="_blank" href="xieyi.html">人才招聘</a> | 
		<a target="_blank" href="xieyi.html">联系我们</a> | 
		<a onclick="$.post('http://www.tieyou.com/tj.html',{'type':'weibo'});" class="weibo" target="_blank" href="http://weibo.com/jiujiupiaowu">关注铁友网</a>
		|<a href="xieyi.html" rel="nofollow" target="_blank" >保险代理</a>
	</p>
	Copyright&nbsp;<a title="火车票" href="http://www.tieyou.com/">www.tieyou.com</a>&nbsp;2009-2013&nbsp;沪ICP备09057645号-2
</div>

<!-- 百度的统计代码 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3d66c13e0ef795c8a00b3b9ca2a8ba38";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script type="text/javascript">
$(document).ready(function() {
	$('.12306yuding').click(function(){
		$("#wapunload").show(); 
	});	
	$('.tipWin_close').click(function(){
		$("#wapunload").hide(); 
	});
	$('#wh_txt190').focus(function(){
		$('#wh_txt190').val('');
		$('#phonefomat').hide();
	});
	$('#btn_send_12306').click(function(){
		var phonetext = $('#wh_txt190').val();
		phonetext = phonetext.replace(/[ ]/g,"")
		if(phonetext=='' || phonetext=='输入手机号码'){
			$('#phonefomat').show();
			$('#phonefomat').html('请输入手机号');
			return false;
		}else if(!phonetext.match(/^1[3|4|5|8][0-9]\d{4,8}$/)){
			$('#phonefomat').show();
			$('#phonefomat').html('请输入正确手机号');
			return false;
		}else{
			phonetext = phonetext.replace(/[ ]/g,"");
			$.post("/index.php?param=/order/sendsmsAd.html",{"phonetext":phonetext},function(data){
				if(data==1){
					$('#psuccfomat').show();
					$('#btn_send_12306').attr('class','btn_send_off');
					$('#btn_send_12306').attr('disabled','true');
					page_cg(120);
					return false;
				}else{
					alert('发送失败');
					return false;
				}
			});
		}
	});
});
//var i = 120;
function page_cg(i) {
    document.getElementById("daojishi").innerHTML ="<font color=red>"+i+"</font> ";
    if (i > 0) {
        i--;
        setTimeout(function(){page_cg(i);},1000);
    }
    else {
    	$('#psuccfomat').hide();
        $('#btn_send_12306').attr('class','btn_send');
        $("#btn_send_12306").removeAttr("disabled"); 
        return false;
    }

    
}

</script></body>
</html>